import smbus
import time

# Constants
BUS_NUMBER = 1
DEVICE_ADDRESS = 0x68

# Register addresses
ACCEL_XOUT_H = 0x2D
GYRO_XOUT_H = 0x33
MAG_XOUT_L = 0x03

# Create an instance of the SMBus object
bus = smbus.SMBus(BUS_NUMBER)

def read_word_2c(address):
    high_byte = bus.read_byte_data(DEVICE_ADDRESS, address)
    low_byte = bus.read_byte_data(DEVICE_ADDRESS, address + 1)
    value = (high_byte << 8) + low_byte
    if value >= 0x8000:
        return -((65535 - value) + 1)
    else:
        return value

def read_accelerometer():
    accel_x = read_word_2c(ACCEL_XOUT_H)
    accel_y = read_word_2c(ACCEL_XOUT_H + 2)
    accel_z = read_word_2c(ACCEL_XOUT_H + 4)
    return accel_x, accel_y, accel_z

def read_gyroscope():
    gyro_x = read_word_2c(GYRO_XOUT_H)
    gyro_y = read_word_2c(GYRO_XOUT_H + 2)
    gyro_z = read_word_2c(GYRO_XOUT_H + 4)
    return gyro_x, gyro_y, gyro_z

def read_magnetometer():
    mag_x = bus.read_byte_data(DEVICE_ADDRESS, MAG_XOUT_L)
    mag_y = bus.read_byte_data(DEVICE_ADDRESS, MAG_XOUT_L + 1)
    mag_z = bus.read_byte_data(DEVICE_ADDRESS, MAG_XOUT_L + 2)
    return mag_x, mag_y, mag_z

# Main loop
while True:
    accel_data = read_accelerometer()
    gyro_data = read_gyroscope()
    mag_data = read_magnetometer()

    # Print the sensor data
    print("Accelerometer (X, Y, Z):", accel_data)
    print("Gyroscope (X, Y, Z):", gyro_data)
    print("Magnetometer (X, Y, Z):", mag_data)

    time.sleep(1)  # Delay before reading again